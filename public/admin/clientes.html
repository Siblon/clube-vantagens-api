<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Clientes</title>
<link rel="stylesheet" href="/assets/app.css">
<style>
  button { cursor: pointer; }
  table { width: 100%; border-collapse: collapse; }
  th, td { border: 1px solid #ccc; padding: 4px; }
  #filters { display: flex; flex-wrap: wrap; gap: 8px; align-items: center; }
  #filters .actions { margin-left: auto; display: flex; gap: 8px; }
  #pager { margin-top: 8px; }
  dialog form { display: flex; flex-direction: column; gap: 8px; }
  #loading { position: fixed; inset: 0; background: rgba(255,255,255,0.7); display: flex; align-items: center; justify-content: center; z-index: 1000; }
  #loading[hidden] { display: none; }
  #loading .spinner { width: 40px; height: 40px; border: 4px solid #ccc; border-top-color: #333; border-radius: 50%; animation: spin 1s linear infinite; }
  @keyframes spin { to { transform: rotate(360deg); } }
</style>
</head>
<body>
<header>
  <nav>
    <a href="/admin/cadastro.html">Cadastro</a>
    <a href="/admin/clientes.html">Clientes</a>
    <a href="/status/health">Status/Health</a>
  </nav>
  <div>
    <label>PIN <input type="password" id="pin" class="pin-input"></label>
    <button id="save-pin">Salvar PIN</button>
  </div>
</header>

<div id="message"></div>

<main>
  <section id="filters" class="card">
    <input type="text" id="q" placeholder="Buscar por CPF/Nome">
    <select id="status">
      <option value="">Todos os status</option>
      <option value="ativo">Ativo</option>
      <option value="inativo">Inativo</option>
    </select>
    <select id="plano">
      <option value="">Todos os planos</option>
      <option value="Mensal">Mensal</option>
      <option value="Semestral">Semestral</option>
      <option value="Anual">Anual</option>
    </select>
    <label>Itens por página
      <select id="page-size">
        <option value="25">25</option>
        <option value="50">50</option>
        <option value="100">100</option>
        <option value="200">200</option>
      </select>
    </label>
    <button id="filtrar">Filtrar</button>
    <button id="limpar" type="button">Limpar</button>
    <div class="actions">
      <button id="btn-generate-ids" type="button">Gerar IDs</button>
      <a href="/admin/importar.html" id="importar-csv">Importar CSV</a>
      <button id="btn-export" type="button">Exportar CSV</button>
      <label><input type="checkbox" id="export-all"> Exportar tudo</label>
    </div>
  </section>
  <div id="loading" hidden><div class="spinner"></div></div>

  <table class="card">
    <thead>
      <tr>
        <th>CPF</th>
        <th>Nome</th>
        <th>Plano</th>
        <th>Status</th>
        <th>Método</th>
        <th>Email</th>
        <th>Telefone</th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody id="rows"></tbody>
  </table>

  <div id="pager">
    <button id="prev" type="button">Anterior</button>
    <span id="info"></span>
    <button id="next" type="button">Próxima</button>
  </div>
</main>

<dialog id="edit-modal">
  <form id="edit-form" method="dialog">
    <label>CPF <input type="text" name="cpf" readonly></label>
    <label>Nome <input type="text" name="nome"></label>
    <label>Plano
      <select name="plano">
        <option value=""></option>
        <option value="Mensal">Mensal</option>
        <option value="Semestral">Semestral</option>
        <option value="Anual">Anual</option>
      </select>
    </label>
    <label>Status
      <select name="status">
        <option value="ativo">ativo</option>
        <option value="inativo">inativo</option>
      </select>
    </label>
    <label>Método de Pagamento
      <select name="metodo_pagamento">
        <option value=""></option>
        <option value="pix">pix</option>
        <option value="cartao_debito">cartao_debito</option>
        <option value="cartao_credito">cartao_credito</option>
        <option value="dinheiro">dinheiro</option>
      </select>
    </label>
    <label>Email <input type="text" name="email"></label>
    <label>Telefone <input type="text" name="telefone"></label>
    <label>Vencimento <input type="date" name="vencimento"></label>
    <menu>
      <button type="button" id="cancel-edit">Cancelar</button>
      <button type="submit" id="save-edit">Salvar</button>
    </menu>
  </form>
</dialog>

<script src="/admin/admin-common.js"></script>
<script type="module" src="/admin/cpf-utils.js"></script>
<script type="module" src="/admin/clientes.js"></script>
</body>
</html>
