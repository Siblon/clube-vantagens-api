<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <title>Deploy Check</title>
</head>
<body>
  <h1>Deploy Check</h1>
  <ul id="results"></ul>
  <script>
  async function test(name, fn){
    const li = document.createElement('li');
    li.textContent = name + ': ...';
    document.getElementById('results').appendChild(li);
    try{
      const ok = await fn();
      li.textContent = name + ': ' + (ok ? 'PASS' : 'FAIL');
    }catch(e){
      li.textContent = name + ': FAIL';
    }
  }

  test('GET /health', async ()=>{
    const r = await fetch('/health');
    return r.ok;
  });

  test('GET /assinaturas?cpf=11111111111', async ()=>{
    const r = await fetch('/assinaturas?cpf=11111111111');
    return [200,404].includes(r.status);
  });

  test('POST /public/lead', async ()=>{
    const r = await fetch('/public/lead',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({email:'test@example.com'})
    });
    return r.ok;
  });
  </script>
</body>
</html>
